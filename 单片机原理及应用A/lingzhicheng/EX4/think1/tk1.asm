//P1-->>ABCDEF,P3.2中断接线k1,P0接静态数码管		
		ORG	 	0000H
		AJMP	START
		ORG		0003H;外部中断0的入口是0003H
		AJMP	INTT0
		ORG		0100H
	
START:	MOV		SP,#60H
		SETB	EX0;开中断
		SETB	IT0
		SETB	EA
		MOV		IP,#01H;设置优先级
		MOV		P3,#0FFH;先将P3全部置为高电平
MAIN:	MOV		DPTR,#TABLE
		MOV		R0,#03H
		MOV		R2,#08H
		ACALL	LOOP
		LJMP	MAIN

LOOP:	MOV		A,R0
		MOV		P1,A
		RL		A
		MOV		R0,A
		LCALL	D1S
		DJNZ	R2,LOOP
		RET
		
INTT0:	MOV		A,P3
		CPL		A
		JZ		RETURN
		LCALL	D10ms	;去抖动
		MOV		A,P3
		CPL		A
		JZ		RETURN
		JB		ACC.2,Pkey0
		RETI
		
Pkey0:	MOV		A,#00H
		MOVC	A,@A+DPTR
		CJNE	A,#0FFH,Pkey1
		LJMP	RETURN
		
Pkey1:	MOV		P0,A
		LCALL	D1S
		INC		DPTR
		LJMP	Pkey0		
		
RETURN:	RETI
		
TABLE:	DB 		0C0H,0F9H,0A4H,0B0H,99H,92H,82H,0F8H
		DB		80H,90H,88H,83H,0C6H,0A1H,86H,8EH
		DB		0FFH

D10ms:	MOV		R7,#25
D4:		MOV		R6,#200
		DJNZ	R6,$
		DJNZ	R7,D4
		RET

D1S:	MOV		R5,#20
D5:		MOV		R6,#100
D6:		MOV		R7,#248
D7:		DJNZ	R7,D7
		DJNZ	R6,D6
		DJNZ	R5,D5
		RET	
		
		END