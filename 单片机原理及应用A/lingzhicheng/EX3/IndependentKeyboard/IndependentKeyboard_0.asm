		ORG		0000H
		AJMP	START
		ORG 	0100H
			
START:	MOV		SP,#60H
MAIN:	LCALL	KEY1;跳转至KEY1
		LJMP	MAIN;重复循环
KEY1:	MOV		P1,#0FFH;P1口全写入1
		MOV		B,A;
		MOV		P2,B;
		MOV		A,P1;读入八个按键的状态，有键按下则为0
		CPL		A;全部取反，有键按下则为1
		JZ		KEY1;如果累加器A全为0，则无键按下，跳转至KEY1重新开始
		LCALL	D10ms;去抖动
		MOV		A,P1;读入八个按键的状态，有键按下则为0
		CPL		A;全部取反，有键按下则为1
		JZ		KEY1;如果累加器A全为0，则无键按下，跳转至KEY1重新开始
		JB		ACC.0,PK0
		JB		ACC.1,PK1
		JB		ACC.2,PK2
		JB		ACC.3,PK3
		JB		ACC.4,PK4
		JB		ACC.5,PK5
		JB		ACC.6,PK6
		JB		ACC.7,PK7
		RET

PK0:	LCALL	PKEY0
		LJMP	KEY1
PK1:	LCALL	PKEY1
		LJMP	KEY1
PK2:	LCALL	PKEY2
		LJMP	KEY1
PK3:	LCALL	PKEY3
		LJMP	KEY1		
PK4:	LCALL	PKEY4
		LJMP	KEY1		
PK5:	LCALL	PKEY5
		LJMP	KEY1
PK6:	LCALL	PKEY6
		LJMP	KEY1
PK7:	LCALL	PKEY7
		LJMP	KEY1	
		
PKEY0:	MOV		B,A;
		MOV		P2,B;
		JNB		P1.0,PKEY0
		LCALL	D10ms
		JNB		P1.0,PKEY0
		RET
PKEY1:	MOV		B,A;
		MOV		P2,B;
		JNB		P1.1,PKEY1
		LCALL	D10ms
		JNB		P1.1,PKEY1
		RET
PKEY2:	MOV		B,A;
		MOV		P2,B;
		JNB		P1.2,PKEY2
		LCALL	D10ms
		JNB		P1.2,PKEY2
		RET
PKEY3:	MOV		B,A;
		MOV		P2,B;
		JNB		P1.3,PKEY3
		LCALL	D10ms
		JNB		P1.3,PKEY3
		RET
PKEY4:	MOV		B,A;
		MOV		P2,B;
		JNB		P1.4,PKEY4
		LCALL	D10ms
		JNB		P1.4,PKEY4
		RET
PKEY5:	MOV		B,A;
		MOV		P2,B;
		JNB		P1.5,PKEY5
		LCALL	D10ms
		JNB		P1.5,PKEY5
		RET
PKEY6:	MOV		B,A;
		MOV		P2,B;
		JNB		P1.6,PKEY6
		LCALL	D10ms
		JNB		P1.6,PKEY6
		RET
PKEY7:	MOV		B,A;
		MOV		P2,B;
		JNB		P1.7,PKEY7
		LCALL	D10ms
		JNB		P1.7,PKEY7
		RET

D10ms:	MOV		R7,#25
D1:		MOV		R6,#200
		DJNZ	R6,$
		DJNZ	R7,D1
		RET
	
		END
			